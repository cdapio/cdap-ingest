!function(a){"use strict";if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var b=module.exports||exports;a(b,require)}else"function"==typeof define&&define.amd?define(["exports","Promise"],a):(window.CDAPStreamClient=window.CDAPStreamClient||{},window.CDAPStreamClient.Promise=window.CDAPStreamClient.Promise||{},a(window.CDAPStreamClient.Promise))}(function(){"use strict";var a=function(){var a=[],b=[],c=[],d=null,e=null,f=[],g=!1,h=!1,i=function(){if(!g&&!h&&d&&a.length){for(;a.length;)a.shift()(d);b=[],c=[],g=!0}},j=function(){if(!g&&!h&&e&&b.length){for(;b.length;)b.shift()(e);a=[],c=[],g=!0}},k=function(){if(!g&&!h&&f.length&&c.length)for(var a=null;f.length>0;)for(a=f.shift();c.length;)c.shift()(a)},l=function(d,e,f){if(h=!0,null!=d){if("function"!=typeof d)throw new TypeError('"success" parameter have to be a function.');a.push(d)}if(null!=e){if("function"!=typeof e)throw new TypeError('"error" parameter have to be a function.');b.push(e)}if(null!=f){if("function"!=typeof f)throw new TypeError('"notify" parameter have to be a function.');c.push(f)}return h=!1,i(),j(),k(),this},m=function(a){return l.apply(this,[null,a])},n=function(a){d=d||a,i()},o=function(a){e=e||a,j()},p=function(a){f.push(a),k()};return{then:l,"catch":m,resolve:n,reject:o,notify:p}};"undefined"!=typeof module&&module.exports?module.exports=a:window.CDAPStreamClient.Promise=a}),function(a){"use strict";if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var b=module.exports||exports;a(b,require)}else"function"==typeof define&&define.amd?define(["exports","Promise"],a):(window.CDAPStreamClient=window.CDAPStreamClient,window.CDAPStreamClient.Utils=window.CDAPStreamClient.Utils||{},a(window.CDAPStreamClient.Utils))}(function(a){"use strict";a.copyObject=function(a,b){var c={},d=function(a){for(var b=Object.keys(a),d="";b.length;)d=b.shift(),c[d]=a[d]};return d(a),d(b),c},a.baseUrl=function(a,b,c){return[c?"https":"http","://",a,":",b].join("")},a.formRequest=function(){var a=Array.prototype.slice.call(arguments);return a.join("/")}}),window.CDAPStreamClient=window.CDAPStreamClient||{},function(){var a=function(a){if(!(a.method&&a.path&&a.host&&a.port))throw new Error('"host", "port", "method", "path" properties are required');a.ssl=null!=a.ssl?a.ssl:!1,a.headers=a.headers||{},a.data=a.data||{};var b=new XMLHttpRequest,c=CDAPStreamClient.Utils,d=new CDAPStreamClient.Promise,e=c.baseUrl(a.host,a.port,a.ssl)+a.path;b.open(a.method,e,!0),b.onreadystatechange=function(){var a=["Request not initialized","Server connection established","Request received","Processing request","Request finished and response is ready"];d.notify(a[b.readyState]),XMLHttpRequest.DONE===b.readyState&&(200===b.status?d.resolve(b.responseText||b.status):d.reject(b.status))};for(var f in a.headers)a.headers.hasOwnProperty(f)&&b.setRequestHeader(f,a.headers[f]);return b.send(a.data),d},b=function(a){if(!(a.method&&a.path&&a.host&&a.port))throw new Error('"host", "port", "method", "path" properties are required');a.ssl=null!=a.ssl?a.ssl:!1,a.headers=a.headers||{},a.data=a.data||{};var b=new XMLHttpRequest,c=CDAPStreamClient.Utils,d=c.baseUrl(a.host,a.port,a.ssl)+a.path;b.open(a.method,d,!1);for(var e in a.headers)a.headers.hasOwnProperty(e)&&b.setRequestHeader(e,a.headers[e]);return b.send(a.data),XMLHttpRequest.DONE===b.readyState?{status:b.status,responseText:b.responseText}:{status:404}};CDAPStreamClient.request=function(c){return c.async=null!=c.async?c.async:!0,c.async?a(c):b(c)},window.FormData&&(CDAPStreamClient.send=function(a){if(!a.path||!a.host||!a.port)throw new Error('"host", "port", "path" properties are required');if(!("string"==typeof a.files&&a.files instanceof Array&&a.files instanceof FormData))throw new Error('"files" property has to be one of the types: String, Array, FormData');a.method="POST",a.ssl=null!=a.ssl?a.ssl:!1,a.headers=a.headers||{};var b=CDAPStreamClient.Utils,c=CDAPStreamClient.Promise,d=new XMLHttpRequest,e=new c,f=b.baseUrl(a.host,a.port,a.ssl)+a.path;return d.onload=function(){200===d.status?e.resolve(d.status):e.reject(d.status)},d.open(a.method,f,!0),d.send(formData),e})}(),function(a){"use strict";if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var b=module.exports||exports;a(b,require)}else"function"==typeof define&&define.amd?define(["exports","Promise"],a):(window.CDAPStreamClient=window.CDAPStreamClient||{},window.CDAPStreamClient.ServiceConnector=window.CDAPStreamClient.ServiceConnector||{},a(window.CDAPStreamClient.ServiceConnector))}(function(a,b){"use strict";var c="undefined"!=typeof window?CDAPStreamClient.Utils:b("./utils"),d=function(a){a=a||{};var d={Authorization:""},e={host:a.host?a.host:"localhost",port:a.port?a.port:1e4,ssl:null!=a.ssl?a.ssl:!1},f=a.authManager||null,g="undefined"!=typeof window?CDAPStreamClient:b("./request-node"),h=function(a){if(f&&f.isAuthEnabled()){var b=f.getToken();d.Authorization=[b.type,b.token].join(" ")}var a=c.copyObject(e,{method:a.method,path:a.path,headers:c.copyObject(d,a.headers?a.headers:{}),data:a.data||"",async:null!=a.async?a.async:!0});return g.request(a)},i=function(a,b,h){if(f&&f.isAuthEnabled()){var i=f.getToken();d.Authorization=[i.type,i.token].join(" ")}var j=c.copyObject(e,{method:"POST",path:a,headers:c.copyObject(d,h?h:{}),filename:b});return g.send(j)},j={request:h},k=!1;try{k="FormData"in window}catch(l){}return("undefined"==typeof window||k)&&(j.send=i),j};"undefined"!=typeof module&&module.exports?module.exports=d:window.CDAPStreamClient.ServiceConnector=d}),function(a){"use strict";if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var b=module.exports||exports;a(b,require)}else"function"==typeof define&&define.amd?define(["exports","Promise"],a):(window.CDAPStreamClient=window.CDAPStreamClient||{},window.CDAPStreamClient.StreamWriter=window.CDAPStreamClient.StreamWriter||{},a(window.CDAPStreamClient.StreamWriter))}(function(){"use strict";var a=function(a,b){if(!a||!b)throw new Error("params are required");var c=a,d=b,e=function(a,b){if(!a)throw new Error('"message" is required');return b=b||{},c.request({method:"POST",path:d,data:JSON.stringify(a),headers:b})};return{write:e}};"undefined"!=typeof module&&module.exports?module.exports=a:window.CDAPStreamClient.StreamWriter=a}),function(a){"use strict";if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var b=module.exports||exports;a(b,require)}else"function"==typeof define&&define.amd?define(["exports","Promise"],a):(window.CDAPStreamClient=window.CDAPStreamClient||{},window.CDAPStreamClient.StreamClient=window.CDAPStreamClient.StreamClient||{},a(window.CDAPStreamClient.StreamClient))}(function(a,b){"use strict";var c="undefined"!=typeof window?CDAPStreamClient.Utils:b("./utils"),d="undefined"!=typeof window?CDAPStreamClient.ServiceConnector:b("./serviceconnector"),e="undefined"!=typeof window?CDAPStreamClient.StreamWriter:b("./streamwriter"),f="/v2",g={StreamID:"<streamid>"},h={BaseStreams:f+"/streams"};h.Stream=c.formRequest(h.BaseStreams,g.StreamID),h.ConsumerID=c.formRequest(h.Stream,"consumer-id"),h.Dequeue=c.formRequest(h.Stream,"dequeue"),h.Config=c.formRequest(h.Stream,"config"),h.Info=c.formRequest(h.Stream,"info"),h.Truncate=c.formRequest(h.Stream,"truncate");var i,j,k=function(a){return a.placeholder=a.placeholder||"StreamID",a.data=a.data||"",h[a.request].replace(g[a.placeholder],a.data)},l=function(a){var b="status"in a?a.status:a.statusCode,c="responseText"in a?a.responseText:a.body.toString();if(200!==b)throw{status:b,message:c,toString:function(){return["Error code: ",this.status," ","Error message: ",this.message].join("")}};return a},m=function(a){if(!a.host||!a.port)throw new Error('"host" and "port" fields are required');a.ssl=null!=a.ssl?a.ssl:!1,j=a.authManager||null,i=new d(a);var b=function(a){var b=k({request:"Stream",data:a});return i.request({method:"PUT",path:b,async:!1})},c=function(a,b){var c=k({request:"Config",data:a}),d={ttl:b};l(i.request({method:"PUT",path:c,data:JSON.stringify(d),async:!1}))},f=function(a){var b=k({request:"Info",data:a}),c=l(i.request({method:"GET",path:b,async:!1}));return JSON.parse(c.responseText).ttl},g=function(a){var b=k({request:"Truncate",data:a});l(i.request({method:"POST",path:b,async:!1}))},h=function(a){f.apply(this,[a]);var b=k({request:"Stream",data:a});return new e(i,b)};return{create:b,setTTL:c,getTTL:f,truncate:g,createWriter:h}};"undefined"!=typeof module&&module.exports?module.exports=m:window.CDAPStreamClient.StreamClient=m});