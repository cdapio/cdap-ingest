var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=Base64._utf8_encode(a);j<a.length;)b=a.charCodeAt(j++),c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i=i+this._keyStr.charAt(e)+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h);return i},decode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<a.length;)e=this._keyStr.indexOf(a.charAt(j++)),f=this._keyStr.indexOf(a.charAt(j++)),g=this._keyStr.indexOf(a.charAt(j++)),h=this._keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i=Base64._utf8_decode(i)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}};window.CDAPAuthHelpers=window.CDAPAuthHelpers||{},window.CDAPAuthHelpers.Browser={getAuthHeaders:function(a,b,c){var d={};return d[a]=b+" "+Base64.encode(c.user+":"+c.pass),d},fetchAuthUrl:function(a,b){a.open("GET",b()+"/v2/ping",!1),a.send();var c=null;return XMLHttpRequest.DONE===a.readyState&&401===a.status&&(c=JSON.parse(a.responseText).auth_uri),c},fetchTokenInfo:function(a,b,c,d){b.open("GET",a(),!1),b.setRequestHeader(d,c()[d]);var e={value:"",type:"",expirationDate:0};if(a&&(b.send(),XMLHttpRequest.DONE===b.readyState&&200===b.status)){var f=JSON.parse(b.responseText);e.value=f.access_token,e.type=f.token_type,e.expirationDate=Date.now()+1e3*f.expires_in}return e}},function(a){"use strict";if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var b=module.exports||exports;a(b,require)}else"function"==typeof define&&define.amd?define(["exports","CDAPAuthManager"],a):a(window)}(function(a,b){"use strict";var c=function(){var a={host:"localhost",port:1e4,ssl:!1,user:"",pass:""},c={value:"",type:"",expirationDate:0},d=null,e=null,f=null,g=null,h="Authorization",i="Basic",j=5e3;"undefined"!=typeof window?(g=CDAPAuthHelpers.Browser,d=new XMLHttpRequest):(g=b("./helper-node"),d=b("http-sync"));var k=g.getAuthHeaders.bind(this,h,i,a),l=function(){return[a.ssl?"https":"http","://",a.host,":",a.port,"/"].join("")},m=g.fetchAuthUrl.bind(this,d,l),n=function(){return e?e[Math.floor(Math.random()*e.length)]:""},o=function(){return null==f&&(e||(e=m()),f=!!e),f},p=g.fetchTokenInfo.bind(this,n,d,k,h),q=function(){return o()&&j>=c.expirationDate-Date.now()&&(c=p()),{token:c.value,type:c.type}},r=function(b){if(!b.username||!b.password)throw new Error('"username" and "password" are required');if(a.user&&a.pass)throw new Error("Client is already configured!");a.user=b.username,a.pass=b.password},s=function(b,c,d){a.host=b,a.port=c,a.ssl=d},t=function(){c.value="",c.type="",c.expirationDate=0},u=function(){return[{name:"username",description:"Username for basic authentication.",secret:!1},{name:"password",description:"Password for basic authentication.",secret:!0}]};return{isAuthEnabled:o,getToken:q,configure:r,setConnectionInfo:s,invalidateToken:t,getRequiredCredentials:u}};"undefined"!=typeof module&&module.exports?module.exports=c:a.CDAPAuthManager=a.CDAPAuthManager||c});